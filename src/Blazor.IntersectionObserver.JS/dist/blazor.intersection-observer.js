!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.OBSERVER_ID_PREFIX="blazor_plugin_observer__";let t=1;const n=new Map;function r(e,t){return e.root===t.root&&e.rootMargin===t.rootMargin&&e.threshold===t.threshold}function o(o,i){null==i&&(i={});const u=function(e){let t=null;for(const[o,i]of n)if(r(e,i.options)){t={id:o,instance:i};break}return t}(i);if(null==u){const r=`${e.OBSERVER_ID_PREFIX}${t++}`,u=new IntersectionObserver(function(e){return t=>{if(!n.has(e))return;const{dotnetRef:r,elements:o}=n.get(e),i=t.reduce((e,t)=>{for(const[n,r]of o)r.has(t.target)&&(e[n]=(e[n]||[]).concat(t));return e},{});Object.keys(i).forEach(e=>{const t=i[e];r.invokeMethodAsync("OnCallback",e,t.map(s))})}}(r),i),c=new Map;return n.set(r,{dotnetRef:o,options:i,observer:u,elements:c}),{id:r,instance:n.get(r)}}return u}function i(e,t){let r=!1;return 0===t.elements.size&&(t.observer.disconnect(),n.delete(e),r=!0),r}function s(e){function t(e){return{X:e.x,Y:e.y,Width:e.width,Height:e.height,Top:e.top,Left:e.left,Bottom:e.bottom,Right:e.right}}return{Target:e.target,IsIntersecting:e.isIntersecting,IntersectionRatio:e.intersectionRatio,Time:e.time,BoundingClientRect:t(e.boundingClientRect),IntersectionRect:t(e.intersectionRect),RootBounds:t(e.rootBounds)}}e.reset=function(){t=1,n.clear()},e.getObserverItems=function(){return n},e.create=function(e,t,n){const r=o(e,n),{instance:i}=r;return i.elements.set(t,new Set([])),r},e.observe=function(e,t,n,r){const{instance:i}=o(e,r);return function(e,t,n){const{elements:r,observer:o}=e,i=r.get(t);return null!=i?i.add(n):r.set(t,new Set([n])),o.observe(n),e}(i,t,n)},e.observeElement=function(e,t){const r=n.values();for(const n of r){const r=n.elements.get(e);if(null!=r&&!r.has(t)){n.observer.observe(t),r.add(t);break}}},e.unobserve=function(e,t){const r=n.values();let o=!1;for(const n of r){const r=n.elements.get(e);if(null!=r&&r.has(t)){n.observer.unobserve(t),r.delete(t),o=!0;break}}return o},e.disconnect=function(e){const t=n.entries();let r=!1;for(const[n,o]of t)if(o.elements.get(e)){o.elements.delete(e),i(n,o),r=!0;break}return r}}(r||(r={})),"undefined"!=typeof window&&(window.BlazorIntersectionObserverJS=r),t.default=r}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiQmxhem9ySW50ZXJzZWN0aW9uT2JzZXJ2ZXJKUyIsIk9CU0VSVkVSX0lEX1BSRUZJWCIsIk9CU0VSVkVSX0lEIiwib2JzZXJ2ZXJJdGVtcyIsIk1hcCIsImhhc1NhbWVPcHRpb25zIiwiYSIsImIiLCJyb290Iiwicm9vdE1hcmdpbiIsInRocmVzaG9sZCIsImdldE9ic2VydmVySXRlbSIsImRvdG5ldFJlZiIsIm9wdGlvbnMiLCJvYnNlcnZlckl0ZW0iLCJpdGVtRm91bmQiLCJpZCIsImluc3RhbmNlIiwiZ2V0SXRlbUZyb21PcHRpb25zIiwib2JzZXJ2ZXIiLCJJbnRlcnNlY3Rpb25PYnNlcnZlciIsIm9ic2VydmVySW5zdGFuY2VJZCIsImVudHJpZXMiLCJoYXMiLCJlbGVtZW50cyIsIm9ic2VydmVyRW50cmllcyIsInJlZHVjZSIsImJhdGNoZWQiLCJlbnRyeSIsIml0ZW0iLCJ0YXJnZXQiLCJjb25jYXQiLCJrZXlzIiwiZm9yRWFjaCIsIm9ic2VydmVySWQiLCJiYXRjaCIsImludm9rZU1ldGhvZEFzeW5jIiwibWFwIiwidG9FbnRyeU9iamVjdCIsIm9uRW50cnlDaGFuZ2UiLCJzZXQiLCJjbGVhbnVwT2JzZXJ2ZXIiLCJpdGVtSWQiLCJpbnN0YW5jZVJlbW92ZWQiLCJzaXplIiwiZGlzY29ubmVjdCIsImRlbGV0ZSIsInRvUmVjdFJlYWRPbmx5T2JqZWN0Iiwib2JqIiwiWCIsIngiLCJZIiwieSIsIldpZHRoIiwid2lkdGgiLCJIZWlnaHQiLCJoZWlnaHQiLCJUb3AiLCJ0b3AiLCJMZWZ0IiwibGVmdCIsIkJvdHRvbSIsImJvdHRvbSIsIlJpZ2h0IiwicmlnaHQiLCJUYXJnZXQiLCJJc0ludGVyc2VjdGluZyIsImlzSW50ZXJzZWN0aW5nIiwiSW50ZXJzZWN0aW9uUmF0aW8iLCJpbnRlcnNlY3Rpb25SYXRpbyIsIlRpbWUiLCJ0aW1lIiwiQm91bmRpbmdDbGllbnRSZWN0IiwiYm91bmRpbmdDbGllbnRSZWN0IiwiSW50ZXJzZWN0aW9uUmVjdCIsImludGVyc2VjdGlvblJlY3QiLCJSb290Qm91bmRzIiwicm9vdEJvdW5kcyIsInJlc2V0IiwiY2xlYXIiLCJnZXRPYnNlcnZlckl0ZW1zIiwiU2V0Iiwib2JzZXJ2ZSIsIm5vZGUiLCJlbGVtZW50Iiwib2JzZXJ2ZXJFbGVtZW50cyIsImFkZCIsIm9ic2VydmVJbnN0YW5jZUVsZW1lbnQiLCJvYnNlcnZlRWxlbWVudCIsImluc3RhbmNlcyIsInZhbHVlcyIsInVub2JzZXJ2ZSIsInJlbW92ZWQiLCJvYnNlcnZlcnMiLCJkaXNjb25uZWN0ZWQiLCJpbnN0YW5jZUlkIiwid2luZG93IiwiZGVmYXVsdCJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxJQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFlBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFB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QkFBWGdHLFNBQ1BBLE9BQXFDLDZCQUFJaEcsR0FHN0NsQyxFQUFBbUksUUFBZWpHIiwiZmlsZSI6ImJsYXpvci5pbnRlcnNlY3Rpb24tb2JzZXJ2ZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJleHBvcnQgaW50ZXJmYWNlIElEb3ROZXRPYmplY3RSZWYge1xyXG4gICAgaW52b2tlTWV0aG9kQXN5bmMobWV0aG9kTmFtZTogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSk6IFByb21pc2U8YW55PjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJbnRlcnNlY3Rpb25PYnNlcnZlckl0ZW0ge1xyXG4gICAgaWQ6IHN0cmluZztcclxuICAgIGluc3RhbmNlOiBJbnRlcnNlY3Rpb25PYnNlcnZlckluc3RhbmNlO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEludGVyc2VjdGlvbk9ic2VydmVySW5zdGFuY2Uge1xyXG4gICAgZG90bmV0UmVmOiBJRG90TmV0T2JqZWN0UmVmO1xyXG4gICAgb2JzZXJ2ZXI6IEludGVyc2VjdGlvbk9ic2VydmVyO1xyXG4gICAgb3B0aW9uczogSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbml0O1xyXG4gICAgZWxlbWVudHM6IE1hcDxzdHJpbmcsIFNldDxFbGVtZW50Pj47XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRWxlbWVudEluc3RhbmNlIHtcclxuICAgIG9ic2VydmVyczogSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbnN0YW5jZVtdO1xyXG59XHJcblxyXG5leHBvcnQgdHlwZSBPbkludGVyc2VjdGlvblVwZGF0ZUZuID0gKGVudHJpZXM6IEludGVyc2VjdGlvbk9ic2VydmVyRW50cnlbXSkgPT4gYW55O1xyXG5cclxubmFtZXNwYWNlIEJsYXpvckludGVyc2VjdGlvbk9ic2VydmVySlMge1xyXG5cclxuICAgIGV4cG9ydCBjb25zdCBPQlNFUlZFUl9JRF9QUkVGSVggPSBcImJsYXpvcl9wbHVnaW5fb2JzZXJ2ZXJfX1wiO1xyXG5cclxuICAgIGxldCBPQlNFUlZFUl9JRCA9IDE7XHJcblxyXG4gICAgY29uc3Qgb2JzZXJ2ZXJJdGVtcyA9IG5ldyBNYXA8c3RyaW5nLCBJbnRlcnNlY3Rpb25PYnNlcnZlckluc3RhbmNlPigpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVzZXQgdGhlIGNvdW50ZXIgYW5kIHRoZSBvYnNlcnZlciBpbnN0YW5jZXNcclxuICAgICAqL1xyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIHJlc2V0KCkge1xyXG4gICAgICAgIE9CU0VSVkVSX0lEID0gMTtcclxuICAgICAgICBvYnNlcnZlckl0ZW1zLmNsZWFyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGhlIG9ic2VydmVyIGl0ZW1zXHJcbiAgICAgKi9cclxuICAgIGV4cG9ydCBmdW5jdGlvbiBnZXRPYnNlcnZlckl0ZW1zKCkge1xyXG4gICAgICAgIHJldHVybiBvYnNlcnZlckl0ZW1zO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2VuZXJhdGUgYSB1bmlxdWUgaWQgZm9yIGFuIG9ic2VydmVyIGl0ZW0uIFxyXG4gICAgICoqL1xyXG4gICAgZnVuY3Rpb24gY3JlYXRlT2JzZXJ2ZXJJdGVtSWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIGAke09CU0VSVkVSX0lEX1BSRUZJWH0ke09CU0VSVkVSX0lEKyt9YDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIHdoZXRoZXIgdGhlIHR3byBvcHRpb25zIGFyZSB0aGUgc2FtZS5cclxuICAgICAqIEBwYXJhbSB7SW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbml0fSBhIC0gQW4gb2JzZXJ2ZXIncyBvcHRpb25zIHRvIGNvbXBhcmUgXHJcbiAgICAgKiBAcGFyYW0ge0ludGVyc2VjdGlvbk9ic2VydmVySW5pdH0gYiAtIEFuIG9ic2VydmVyJ3Mgb3B0aW9ucyB0byBjb21wYXJlXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSBXaGV0aGVyIHRoZSB0d28gb3B0aW9ucyBhcmUgdGhlIHNhbWVcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gaGFzU2FtZU9wdGlvbnMoYTogSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbml0LCBiOiBJbnRlcnNlY3Rpb25PYnNlcnZlckluaXQpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICBhLnJvb3QgPT09IGIucm9vdCAmJlxyXG4gICAgICAgICAgICBhLnJvb3RNYXJnaW4gPT09IGIucm9vdE1hcmdpbiAmJlxyXG4gICAgICAgICAgICBhLnRocmVzaG9sZCA9PT0gYi50aHJlc2hvbGRcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSWYgdGhlcmUncyBhbiBleGlzdGluZyBvYnNlcnZlciBpdGVtLCByZXRyaWV2ZSBpdCBnaXZlbiB0aGUgc2FtZSBvcHRpb25zLlxyXG4gICAgICogQHBhcmFtIHtJbnRlcnNlY3Rpb25PYnNlcnZlckluaXR9IG9wdGlvbnMgLSBUaGUgb2JzZXJ2ZXIgb3B0aW9uc1xyXG4gICAgICogQHJldHVybnMge0ludGVyc2VjdGlvbk9ic2VydmVySXRlbSB8IG51bGx9IC0gVGhlIG9ic2VydmVyIGl0ZW0gb3Igbm90aGluZyBcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZ2V0SXRlbUZyb21PcHRpb25zKG9wdGlvbnM6IEludGVyc2VjdGlvbk9ic2VydmVySW5pdCk6IEludGVyc2VjdGlvbk9ic2VydmVySXRlbSB8IG51bGwge1xyXG4gICAgICAgIGxldCBpdGVtRm91bmQ6IChJbnRlcnNlY3Rpb25PYnNlcnZlckl0ZW0gfCBudWxsKSA9IG51bGw7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgW2lkLCBpbnN0YW5jZV0gb2Ygb2JzZXJ2ZXJJdGVtcykge1xyXG4gICAgICAgICAgICBpZiAoaGFzU2FtZU9wdGlvbnMob3B0aW9ucywgaW5zdGFuY2Uub3B0aW9ucykpIHtcclxuICAgICAgICAgICAgICAgIGl0ZW1Gb3VuZCA9IHsgaWQsIGluc3RhbmNlIH07XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGl0ZW1Gb3VuZDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEFkZCBhbiBlbGVtZW50IHRvIHRoZSBvYnNlcnZlciBpbnN0YW5jZS5cclxuICAgICAqIEBwYXJhbSB7SW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbnN0YW5jZX0gaW5zdGFuY2UgLSBUaGUgb2JzZXJ2ZXIgaW5zdGFuY2VcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIFRoZSBlbGVtZW50IHRvIGFkZCB0byB0aGUgaW5zdGFuY2VcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBvYnNlcnZlcklkIC0gVGhlIG9ic2VydmVyIGlkXHJcbiAgICAgKiBAcmV0dXJucyB7SW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbnN0YW5jZX0gLSBUaGUgb2JzZXJ2ZXIgaW5zdGFuY2VcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gb2JzZXJ2ZUluc3RhbmNlRWxlbWVudChpbnN0YW5jZTogSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbnN0YW5jZSwgb2JzZXJ2ZXJJZDogc3RyaW5nLCBlbGVtZW50OiBFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgeyBlbGVtZW50cywgb2JzZXJ2ZXIgfSA9IGluc3RhbmNlO1xyXG4gICAgICAgIGNvbnN0IG9ic2VydmVyRWxlbWVudHMgPSBlbGVtZW50cy5nZXQob2JzZXJ2ZXJJZCk7XHJcblxyXG4gICAgICAgIGlmIChvYnNlcnZlckVsZW1lbnRzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXJFbGVtZW50cy5hZGQoZWxlbWVudCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZWxlbWVudHMuc2V0KG9ic2VydmVySWQsIG5ldyBTZXQ8RWxlbWVudD4oW2VsZW1lbnRdKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBvYnNlcnZlci5vYnNlcnZlKGVsZW1lbnQpO1xyXG4gICAgICAgIHJldHVybiBpbnN0YW5jZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBvciB1c2UgYW4gZXhpc3RpbmcgaW50ZXJzZWN0aW9uIG9ic2VydmVyIGl0ZW0uXHJcbiAgICAgKiBAcGFyYW0ge0RvdE5ldE9iamVjdFJlZn0gZG90bmV0UmVmIC0gVGhlIGN1cnJlbnQgZG90bmV0IGJsYXpvciByZWZlcmVuY2VcclxuICAgICAqIEBwYXJhbSB7SW50ZXJzZWN0aW9uT2JzZXJ2ZXJFbnRyeUluaXR9IG9wdGlvbnMgLSBUaGUgb2JzZXJ2ZXIgb3B0aW9uc1xyXG4gICAgICogQHJldHVybnMge0ludGVyc2VjdGlvbk9ic2VydmVySXRlbX0gLSBUaGUgaW50ZXJzZWN0aW9uIG9ic2VydmVyIGl0ZW1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZ2V0T2JzZXJ2ZXJJdGVtKGRvdG5ldFJlZjogSURvdE5ldE9iamVjdFJlZiwgb3B0aW9uczogSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbml0KTogSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJdGVtIHtcclxuICAgICAgICBpZiAob3B0aW9ucyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIG9wdGlvbnMgPSB7fTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IG9ic2VydmVySXRlbSA9IGdldEl0ZW1Gcm9tT3B0aW9ucyhvcHRpb25zKTtcclxuXHJcbiAgICAgICAgaWYgKG9ic2VydmVySXRlbSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlkID0gY3JlYXRlT2JzZXJ2ZXJJdGVtSWQoKTtcclxuICAgICAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIob25FbnRyeUNoYW5nZShpZCksIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICBjb25zdCBlbGVtZW50cyA9IG5ldyBNYXA8c3RyaW5nLCBTZXQ8RWxlbWVudD4+KCk7XHJcblxyXG4gICAgICAgICAgICBvYnNlcnZlckl0ZW1zLnNldChpZCwgeyBkb3RuZXRSZWYsIG9wdGlvbnMsIG9ic2VydmVyLCBlbGVtZW50cyB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBpZCxcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlOiBvYnNlcnZlckl0ZW1zLmdldChpZCkgYXMgSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbnN0YW5jZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG9ic2VydmVySXRlbTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBhIGludGVyc2VjdGlvbiBvYnNlcnZlci5cclxuICAgICAqIEBwYXJhbSB7SURvdE5ldE9iamVjdFJlZn0gZG90bmV0UmVmIC0gVGhlIGRvdG5ldCBpbnRlcm9wIHJlZmVyZW5jZVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGlkIC0gVGhlIGluc3RhbmNlIGlkIG9mIHRoZSBcIm9ic2VydmVyXCJcclxuICAgICAqIEBwYXJhbSB7SW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbml0fSBvcHRpb25zIC0gVGhlIGludGVyc2VjdGlvbiBvYnNldmVyIG9wdGlvbnNcclxuICAgICAqIEByZXR1cm5zIHtJbnRlcnNlY3Rpb25PYnNlcnZlckl0ZW19IC0gVGhlIG9ic2VydmVyIGl0ZW1cclxuICAgICAqL1xyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZShkb3RuZXRSZWY6IElEb3ROZXRPYmplY3RSZWYsIGlkOiBzdHJpbmcsIG9wdGlvbnM6IEludGVyc2VjdGlvbk9ic2VydmVySW5pdCkge1xyXG4gICAgICBjb25zdCBpdGVtID0gZ2V0T2JzZXJ2ZXJJdGVtKGRvdG5ldFJlZiwgb3B0aW9ucyk7XHJcbiAgICAgIGNvbnN0IHsgaW5zdGFuY2UgfSA9IGl0ZW07XHJcbiAgICAgIGluc3RhbmNlLmVsZW1lbnRzLnNldChpZCwgbmV3IFNldDxFbGVtZW50PihbXSkpO1xyXG4gICAgICByZXR1cm4gaXRlbTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE9ic2VydmUgdGhlIHRhcmdldCBub2RlIHVzaW5nIGEgbmV3IG9yIGV4aXN0aW5nIG9ic2VydmVyXHJcbiAgICAgKiBAcGFyYW0ge0lEb3ROZXRPYmplY3RSZWZ9IGRvdG5ldFJlZiAtIFRoZSBkb3RuZXQgaW50ZXJvcCByZWZlcmVuY2VcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpZCAtIFRoZSBpbnN0YW5jZSBpZCBvZiB0aGUgXCJvYnNlcnZlclwiXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IG5vZGUgLSBUaGUgbm9kZSB0byBvYnNlcnZlXHJcbiAgICAgKiBAcGFyYW0ge0ludGVyc2VjdGlvbk9ic2VydmVySW5pdH0gb3B0aW9ucyAtIFRoZSBpbnRlcnNlY3Rpb24gb2JzZXJ2ZXIgb3B0aW9uc1xyXG4gICAgICogQHJldHVybnMge0ludGVyc2VjdGlvbk9ic2VydmVySW5zdGFuY2V9IC0gVGhlIG9ic2VydmVyIGluc3RhbmNlXHJcbiAgICAgKi9cclxuICAgIGV4cG9ydCBmdW5jdGlvbiBvYnNlcnZlKGRvdG5ldFJlZjogSURvdE5ldE9iamVjdFJlZiwgaWQ6IHN0cmluZywgbm9kZTogRWxlbWVudCwgb3B0aW9uczogSW50ZXJzZWN0aW9uT2JzZXJ2ZXJJbml0KSB7XHJcbiAgICAgICAgY29uc3QgeyBpbnN0YW5jZSB9ID0gZ2V0T2JzZXJ2ZXJJdGVtKGRvdG5ldFJlZiwgb3B0aW9ucyk7XHJcbiAgICAgICAgcmV0dXJuIG9ic2VydmVJbnN0YW5jZUVsZW1lbnQoaW5zdGFuY2UsIGlkLCBub2RlKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE9ic2VydmUgYW4gZWxlbWVudCBmb3IgdGhlIG9ic2VydmVyIGluc3RhbmNlLlxyXG4gICAgICogQHBhcmFtIGlkIC0gVGhlIG9ic2VydmVyIGlkXHJcbiAgICAgKiBAcGFyYW0gZWxlbWVudCAtIFRoZSBlbGVtZW50IHRvIG9ic2VydmVcclxuICAgICAqL1xyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIG9ic2VydmVFbGVtZW50KGlkOiBzdHJpbmcsIGVsZW1lbnQ6IEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBpbnN0YW5jZXMgPSBvYnNlcnZlckl0ZW1zLnZhbHVlcygpO1xyXG5cclxuICAgICAgICBmb3IgKGNvbnN0IGluc3RhbmNlIG9mIGluc3RhbmNlcykge1xyXG4gICAgICAgICAgICBjb25zdCBlbGVtZW50cyA9IGluc3RhbmNlLmVsZW1lbnRzLmdldChpZCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoZWxlbWVudHMgIT0gbnVsbCAmJiAhZWxlbWVudHMuaGFzKGVsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5vYnNlcnZlci5vYnNlcnZlKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudHMuYWRkKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmUgdGhlIGVsZW1lbnQgZnJvbSB0aGUgb2JzZXJ2ZXIgaW5zdGFuY2UgYW5kXHJcbiAgICAgKiB1bm9ic2VydmUgdGhlIGVsZW1lbnQuXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gaWQgLSBUaGUgb2JzZXJ2ZXIgaWRcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIFRoZSBub2RlIHRvIHVub2JzZXJ2ZVxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gV2hldGhlciB0aGUgZWxlbWVudCBoYXMgYmVlbiB1bm9ic2VydmVkXHJcbiAgICAgKi9cclxuICAgIGV4cG9ydCBmdW5jdGlvbiB1bm9ic2VydmUoaWQ6IHN0cmluZywgZWxlbWVudDogRWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IGluc3RhbmNlcyA9IG9ic2VydmVySXRlbXMudmFsdWVzKCk7XHJcbiAgICAgICAgbGV0IHJlbW92ZWQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBpbnN0YW5jZSBvZiBpbnN0YW5jZXMpIHtcclxuICAgICAgICAgICAgY29uc3QgZWxlbWVudHMgPSBpbnN0YW5jZS5lbGVtZW50cy5nZXQoaWQpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGVsZW1lbnRzICE9IG51bGwgJiYgZWxlbWVudHMuaGFzKGVsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5vYnNlcnZlci51bm9ic2VydmUoZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50cy5kZWxldGUoZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcmVtb3ZlZDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlbGV0ZSB0aGUgZWxlbWVudHMgZnJvbSB0aGUgb2JzZXJ2ZXIgaW5zdGFuY2UgXHJcbiAgICAgKiBhbmQgdHJpZ2dlciBjbGVhbmluZyB1cCB0aGUgb2JzZXJ2ZXJzLlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGlkIC0gVGhlIG9ic2VydmVyIGluc3RhbmNlIGlkXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSBXaGV0aGVyIHRoZSBlbGVtZW50cyBoYXZlXHJcbiAgICAgKiBiZWVuIHJlbW92ZWQgZnJvbSB0aGUgb2JzZXJ2ZXIgaW5zdGFuY2VcclxuICAgICAqL1xyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIGRpc2Nvbm5lY3QoaWQ6IHN0cmluZykge1xyXG4gICAgICAgIGNvbnN0IG9ic2VydmVycyA9IG9ic2VydmVySXRlbXMuZW50cmllcygpO1xyXG4gICAgICAgIGxldCBkaXNjb25uZWN0ZWQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBbaW5zdGFuY2VJZCwgaW5zdGFuY2VdIG9mIG9ic2VydmVycykge1xyXG4gICAgICAgICAgICBpZiAoaW5zdGFuY2UuZWxlbWVudHMuZ2V0KGlkKSkge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuZWxlbWVudHMuZGVsZXRlKGlkKTtcclxuICAgICAgICAgICAgICAgIGNsZWFudXBPYnNlcnZlcihpbnN0YW5jZUlkLCBpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICBkaXNjb25uZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBkaXNjb25uZWN0ZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBJZiB0aGVyZSBhcmUgbm8gZWxlbWVudHMgaW4gdGhlIG9ic2VydmVyXHJcbiAgICAgKiBpbnN0YW5jZSwgZGlzY29ubmVjdCB0aGUgb2JzZXJ2ZXIgYW5kIHJlbW92ZVxyXG4gICAgICogaXQgZnJvbSB0aGUgb2JzZXJ2ZXIgaW5zdGFuY2VzLlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGl0ZW1JZCAtIFRoZSBvYnNlcnZlciBpdGVtIGlkXHJcbiAgICAgKiBAcGFyYW0ge0ludGVyc2VjdGlvbk9ic2VydmVySW5zdGFuY2V9IGluc3RhbmNlIC0gVGhlIGluc3RhbmNlIHRvIHJlbW92ZVxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gV2hldGhlciB0aGUgaW5zdGFuY2UgaGFzIGJlZW4gcmVtb3ZlZFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjbGVhbnVwT2JzZXJ2ZXIoaXRlbUlkOiBzdHJpbmcsIGluc3RhbmNlOiBJbnRlcnNlY3Rpb25PYnNlcnZlckluc3RhbmNlKSB7XHJcbiAgICAgICAgbGV0IGluc3RhbmNlUmVtb3ZlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiAoaW5zdGFuY2UuZWxlbWVudHMuc2l6ZSA9PT0gMCkge1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5vYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcbiAgICAgICAgICAgIG9ic2VydmVySXRlbXMuZGVsZXRlKGl0ZW1JZCk7XHJcbiAgICAgICAgICAgIGluc3RhbmNlUmVtb3ZlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gaW5zdGFuY2VSZW1vdmVkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSB0cmlnZ2VyZWQgd2hlbiBhblxyXG4gICAgICogZWxlbWVudCBoYXMgYW4gaW50ZXJzZWN0aW9uIHVwZGF0ZS5cclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBvYnNlcnZlckluc3RhbmNlSWQgLSBUaGUgaW5zdGFuY2UgaWRcclxuICAgICAqIEByZXR1cm5zIHtPbkludGVyc2VjdGlvblVwZGF0ZUZufSAtIFRoZSBmdW5jdGlvbiB0cmlnZ2VyZWQgYnkgYW4gaW50ZXJzZWN0aW9uIHVwZGF0ZVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBvbkVudHJ5Q2hhbmdlKG9ic2VydmVySW5zdGFuY2VJZDogc3RyaW5nKTogT25JbnRlcnNlY3Rpb25VcGRhdGVGbiB7XHJcbiAgICAgICAgcmV0dXJuIChlbnRyaWVzOiBJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5W10pID0+IHtcclxuICAgICAgICAgICAgaWYgKCFvYnNlcnZlckl0ZW1zLmhhcyhvYnNlcnZlckluc3RhbmNlSWQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHsgZG90bmV0UmVmLCBlbGVtZW50cyB9ID0gb2JzZXJ2ZXJJdGVtcy5nZXQob2JzZXJ2ZXJJbnN0YW5jZUlkKSBhcyBJbnRlcnNlY3Rpb25PYnNlcnZlckluc3RhbmNlO1xyXG5cclxuICAgICAgICAgICAgY29uc3Qgb2JzZXJ2ZXJFbnRyaWVzID0gZW50cmllcy5yZWR1Y2UoKGJhdGNoZWQsIGVudHJ5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtpZCwgaXRlbV0gb2YgZWxlbWVudHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5oYXMoZW50cnkudGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXRjaGVkW2lkXSA9IChiYXRjaGVkW2lkXSB8fCBbXSkuY29uY2F0KGVudHJ5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYmF0Y2hlZDtcclxuICAgICAgICAgICAgfSwge30pO1xyXG5cclxuICAgICAgICAgICAgT2JqZWN0LmtleXMob2JzZXJ2ZXJFbnRyaWVzKS5mb3JFYWNoKChvYnNlcnZlcklkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBiYXRjaCA9IG9ic2VydmVyRW50cmllc1tvYnNlcnZlcklkXSBhcyBJbnRlcnNlY3Rpb25PYnNlcnZlckVudHJ5W107XHJcbiAgICAgICAgICAgICAgICBkb3RuZXRSZWYuaW52b2tlTWV0aG9kQXN5bmMoXCJPbkNhbGxiYWNrXCIsIG9ic2VydmVySWQsIGJhdGNoLm1hcCh0b0VudHJ5T2JqZWN0KSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbnZlcnQgdGhlIG9ic2VydmVyIGVudHJ5IHRvIGFuIG9iamVjdCB0aGF0XHJcbiAgICAgKiB3aWxsIGJlIHBhcnNlZCB0byB0aGUgY2FsbGJhY2suXHJcbiAgICAgKiBAcGFyYW0ge0ludGVyc2VjdGlvbk9ic2VydmVyRW50cnl9IGVudHJ5IC0gVGhlIG9ic2VydmVyIGVudHJ5XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHRvRW50cnlPYmplY3QoZW50cnk6IEludGVyc2VjdGlvbk9ic2VydmVyRW50cnkpIHtcclxuICAgICAgICBmdW5jdGlvbiB0b1JlY3RSZWFkT25seU9iamVjdChvYmo6IERPTVJlY3RSZWFkT25seSkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgWDogb2JqLngsXHJcbiAgICAgICAgICAgICAgICBZOiBvYmoueSxcclxuICAgICAgICAgICAgICAgIFdpZHRoOiBvYmoud2lkdGgsXHJcbiAgICAgICAgICAgICAgICBIZWlnaHQ6IG9iai5oZWlnaHQsXHJcbiAgICAgICAgICAgICAgICBUb3A6IG9iai50b3AsXHJcbiAgICAgICAgICAgICAgICBMZWZ0OiBvYmoubGVmdCxcclxuICAgICAgICAgICAgICAgIEJvdHRvbTogb2JqLmJvdHRvbSxcclxuICAgICAgICAgICAgICAgIFJpZ2h0OiBvYmoucmlnaHRcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIFRhcmdldDogZW50cnkudGFyZ2V0LFxyXG4gICAgICAgICAgICBJc0ludGVyc2VjdGluZzogZW50cnkuaXNJbnRlcnNlY3RpbmcsXHJcbiAgICAgICAgICAgIEludGVyc2VjdGlvblJhdGlvOiBlbnRyeS5pbnRlcnNlY3Rpb25SYXRpbyxcclxuICAgICAgICAgICAgVGltZTogZW50cnkudGltZSxcclxuICAgICAgICAgICAgQm91bmRpbmdDbGllbnRSZWN0OiB0b1JlY3RSZWFkT25seU9iamVjdChlbnRyeS5ib3VuZGluZ0NsaWVudFJlY3QgYXMgRE9NUmVjdFJlYWRPbmx5KSxcclxuICAgICAgICAgICAgSW50ZXJzZWN0aW9uUmVjdDogdG9SZWN0UmVhZE9ubHlPYmplY3QoZW50cnkuaW50ZXJzZWN0aW9uUmVjdCBhcyBET01SZWN0UmVhZE9ubHkpLFxyXG4gICAgICAgICAgICBSb290Qm91bmRzOiB0b1JlY3RSZWFkT25seU9iamVjdChlbnRyeS5yb290Qm91bmRzIGFzIERPTVJlY3RSZWFkT25seSlcclxuICAgICAgICAgIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICB3aW5kb3dbXCJCbGF6b3JJbnRlcnNlY3Rpb25PYnNlcnZlckpTXCJdID0gQmxhem9ySW50ZXJzZWN0aW9uT2JzZXJ2ZXJKUztcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQmxhem9ySW50ZXJzZWN0aW9uT2JzZXJ2ZXJKUzsiXSwic291cmNlUm9vdCI6IiJ9